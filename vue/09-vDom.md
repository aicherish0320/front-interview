# 说说你对虚拟 DOM 的理解？

# 思路

- vDom 是什么？
- 引入 vDom 的好处
- vDom 如何生成，又如何成为 dom
- 在后续的 diff 中的作用

# 回答范例

- 虚拟 dom 顾名思义就是虚拟的 dom 对象，它本身就是一个 Javascript 对象，只不过它是通过不同的属性去描述一个视图结构
- 通过引入 vDom 我们可以获得如下好处
  - 将真实元素抽象成 VNode，有效减少直接操作 dom 次数，从而提高程序性能实现跨平台。
  - 同一 VNode 节点可以渲染成不同平台上对应的内容，比如：渲染在浏览器是 dom 元素节点，渲染在 Native 变成对应的控件、可以实现 SSR、渲染到 WebGL 中等等。
  - Vue3 中允许开发者基于 VNode 实现自定义渲染器，以便于针对不同平台进行渲染
  - 直接操作 dom 是又限制的，比如：diff、clone 等操作，一个真实元素上有许多内容，如果直接对其进行 diff 操作，会去额外 diff 一些没有必要的内容；同样的，如果需要进行 clone 那么需要将其全部内容进行复制，这也是没必要的。但是，如果将这些操作转移到 JavaScript 对象上，那么就变得简单了。
  - 操作 dom 是比较昂贵的操作的，频繁的 dom 操作容易引起页面的重绘和回流，但是通过对象 VNode 进行中间处理，可以有效直接操作 dom 的次数，从而减少页面重绘和回流。
- vDom 如何生成？在 Vue 中我们常常会为组件编写模板 - template，这个模板会被编译器 - compiler 编译为渲染函数，在接下来的挂载过程中会调用 render 函数，返回的对象就是虚拟 dom。但它们还不是真正的 dom，所以会在后续的 patch 过程中进一步转化为 dom

```js
template -> render function -> VNode -> dom
```

- 挂载过程结束后，vue 程序进入更新流程。如果某些响应式数据发生变化，将会引起组件重新 render，此时就会生成新的 vDom，和上一次的渲染结果 diff 就能得到变化的地方，从而转换为最小量的 dom 操作，高效更新视图。
